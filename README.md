# GR-CLUE: A simple tool to assess the validity of nanoparticle growth rate deduced from size distribution data

GR-CLUE is a tool for assessing if observed growth of ~sub-10 nm aerosol particles can be interpreted with conventional growth rate (GR) analysis.

* GR calculations are generally not valid for the very smallest nanoparticles or molecular clusters, as their growth involves stochastic effects that require modeling of the cluster size distribution dynamics by a discrete, molecule-by-molecule model.
* GR-CLUE uses high-resolution nanoparticle size distribution data to assess the threshold size range above which GR becomes a valid concept.
* GR is expected to become valid when the metric *&delta;*<sup>2</sup>:*&delta;* decreases to very low values of << 1.
* The principles of the applied metric and GR are discussed in the study by Olenius et al. (DOI:10.1038/s41598-018-32610-z; see the citation below).

Note that the metric is indicative:

* The assessed threshold sizes are not expected to be exact.
* Instead, the approximative size range and its trends are meaningful: the threshold sizes are expected to increase with e.g. (1) increasing molecular size, (2) increasing nanoparticle evaporation, i.e. less efficient particle formation, and (3) decreasing condensable vapor concentration.

## Usage

The input is given in two .m files: one that contains info on the settings on e.g. fitting size distribution functions, and one that gives the size distribution data by loading and possible pre-processing of files. Example files "input_settings_example.m" and "input_data_example.m" are included, and contain detailed information on the settings. GR-CLUE is called by

```console
gr_clue('input_settings_example.m','input_data_example.m')
```

This generates visualization of the metric *&delta;*<sup>2</sup>:*&delta;* and of fits to the size distribution data that are used to determine the metric.
Note that the fits need to be examined: if they do not seem reasonable and/or give bad goodness-of-fit assessment (marked in the figures, if the fits are very bad), the results should be discarded.

* The threshold sizes can be determined at different times, e.g. at the so-called appearance times that are often used in GR analysis, over the whole time range, or at a steady state.
* For demonstration purposes, the synthetic example data, generated by a discrete cluster dynamics model, has a very high size resolution. In practice the resolution is typically lower and data may also involve more noise. In such case, examining (averaged) steady-state distributions may be a reasonable approach for assessing the discrete regime, while keeping in mind that it can vary under time-dependent conditions.
* The tool doesn't include assessment of any growth rates, as sophisticated methods are available for this (e.g. TREND (DOI:10.5194/acp-18-1307-2018); BAYROSOL (DOI:10.5194/gmd-14-3715-2021); in the absence of coagulation and scavenging effects also the so-called appearance time method).

## Prerequisites

* Matlab

## Citation

If you use the codes provided in this repository in any study, please cite at least one of the following works:

* This repository (https://github.com/tolenius/GR-CLUE)
* Olenius et al.: Robust metric for quantifying the importance of stochastic effects on nanoparticle growth, *Sci. Rep.* 8, 14160 (2018), DOI:10.1038/s41598-018-32610-z
* Kontkanen et al.: What controls the observed size-dependency of the growth rates of sub-10 nm atmospheric particles? *Environ. Sci.: Atmos.* 2, 449-468 (2022), DOI:10.1039/D1EA00103E

## License

This project is licensed under the terms of the GNU General Public License v3.0, as provided with this repository.

## Authors

Code developer: **Tinja Olenius** (tinja.olenius@alumni.helsinki.fi)
